{% extends 'base.html.twig' %}
{% block title %}Mes campagnes | WasteWise{% endblock %}

{% block body %}
<div class="ww-app">
  {% include 'campagne/_side_user.html.twig' %}

  <main class="ww-main">
    <div class="ww-topbar">
      <div>
        <div class="ww-h1">‚úÖ Mes campagnes</div>
        <div class="ww-sub">Campagnes o√π je suis inscrit</div>
      </div>
      <div class="ww-top-actions">
        <a class="ww-top-btn" href="{{ path('campagne_index') }}">üì£ Toutes les campagnes</a>
      </div>
    </div>

    {# Flash messages (si tu en utilises) #}
    {% for label, messages in app.flashes %}
      {% for msg in messages %}
        <div class="ww-card2" style="margin-bottom:10px;">
          <b>{{ label|upper }}</b> ‚Äî {{ msg }}
        </div>
      {% endfor %}
    {% endfor %}

    <section class="ww-card2">
      <div class="ww-card2-title">Liste</div>

      <table class="ww-table">
        <thead>
          <tr>
            <th>Campagne</th>
            <th>Inscrit le</th>
            <th style="width:220px;">Action</th>
          </tr>
        </thead>
        <tbody>
        {% for p in items %}
          {% set camp = p.campagne %}
          <tr>
            <td>
              <b>{{ camp ? camp.titre : '‚Äî' }}</b>
              {% if camp and camp.statut is defined %}
                {% if camp.statut == 'ACTIVE' %}
                  <span class="ww-tag ww-tag-ok" style="margin-left:8px;">ACTIVE</span>
                {% elseif camp.statut == 'BROUILLON' %}
                  <span class="ww-tag ww-tag-warn" style="margin-left:8px;">BROUILLON</span>
                {% else %}
                  <span class="ww-tag ww-tag-bad" style="margin-left:8px;">TERMINEE</span>
                {% endif %}
              {% endif %}
            </td>

            <td>{{ p.joinedAt ? p.joinedAt|date('d/m/Y H:i') : '‚Äî' }}</td>

            <td>
              {% if camp %}
                <a class="ww-top-btn ww-btn-mini" href="{{ path('campagne_show', { id: camp.id }) }}">üëÅÔ∏è Voir</a>
              {% else %}
                <span style="opacity:.7;">‚Äî</span>
              {% endif %}
            </td>
          </tr>
        {% else %}
          <tr>
            <td colspan="3" style="opacity:.7;">Aucune campagne rejointe.</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </section>

  </main>
</div>
{% endblock %}
