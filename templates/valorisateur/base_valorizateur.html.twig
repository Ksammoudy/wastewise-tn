{# templates/valorisateur/base_valorizateur.html.twig #}
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Valorisateur | WasteWise{% endblock %}</title>

  {# Bootstrap CSS #}
  <link rel="stylesheet" href="{{ asset('assets/vendor/bootstrap/css/bootstrap.min.css') }}">

  {# Bootstrap Icons #}
  <link rel="stylesheet" href="{{ asset('assets/vendor/bootstrap-icons/bootstrap-icons.css') }}">

  {# Font Awesome #}
  <link rel="stylesheet" href="{{ asset('assets/vendor/font-awesome/css/all.min.css') }}">

  {# Ton CSS template #}
  <link rel="stylesheet" href="{{ asset('assets/css/style.css') }}">

  <style>
    .main-wrapper { display:flex; min-height:100vh; }
    .sidebar { width:280px; flex:0 0 280px; border-right:1px solid rgba(0,0,0,.08); background:#fff; }
    .page-wrapper { flex:1 1 auto; min-width:0; background:#f8fafc; }
    .page-header { position:sticky; top:0; z-index:10; }
  </style>

  {% block stylesheets %}{% endblock %}
</head>

<body>

{% set route = app.request.attributes.get('_route') %}
{% set userLabel = app.user ? app.user.userIdentifier : 'User' %}
{% set firstChar = userLabel|first|upper %}

<div class="main-wrapper">

  {# ===== SIDEBAR ===== #}
  <aside class="sidebar">

    <div class="p-3 border-bottom">
      <a href="{{ path('app_dashboard_valorizateur') }}" 
         class="d-flex align-items-center gap-2 text-decoration-none">
        <span class="fw-bold text-success">WasteWise TN</span>
      </a>
      <div class="small text-muted">Valorizer Space</div>
    </div>

    <div class="p-3 border-bottom">
      <div class="d-flex align-items-center gap-2">
        <div class="rounded-circle d-flex align-items-center justify-content-center fw-bold"
             style="width:42px;height:42px;background:#e8f5ee;color:#166534;">
          {{ firstChar }}
        </div>
        <div class="min-w-0">
          <div class="fw-semibold text-truncate">{{ userLabel }}</div>
          <div class="small text-muted">
            VALORIZER
          </div>
        </div>
      </div>
    </div>

    <div class="px-2 py-3">
      <ul class="nav flex-column gap-1">

        <li class="nav-item">
          <a class="nav-link {{ route == 'app_dashboard_valorizateur' ? 'active fw-bold' : '' }}"
             href="{{ path('app_dashboard_valorizateur') }}">
            <i class="bi bi-speedometer2 me-2"></i> Dashboard
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link {{ route == 'app_valorizateur_historique' ? 'active fw-bold' : '' }}"
             href="{{ path('app_valorizateur_historique') }}">
            <i class="bi bi-clock-history me-2"></i> History
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link {{ route starts with 'val_appel_' ? 'active fw-bold' : '' }}"
             href="{{ path('val_appel_index') }}">
            <i class="bi bi-megaphone me-2"></i> Calls for Offers
          </a>
        </li>

        <li class="nav-item mt-2">
          <a class="nav-link text-danger" href="{{ path('app_logout') }}">
            <i class="bi bi-box-arrow-right me-2"></i> Logout
          </a>
        </li>

      </ul>
    </div>

  </aside>

  {# ===== PAGE CONTENT ===== #}
  <div class="page-wrapper">

    <header class="page-header bg-white border-bottom px-4 py-3 d-flex align-items-center justify-content-between">
      <div class="fw-bold">Valorizer Dashboard</div>

      {% if app.user %}
        <div class="d-flex align-items-center gap-2">
          <i class="bi bi-person-circle"></i>
          <span class="small text-muted">{{ app.user.userIdentifier }}</span>
        </div>
      {% endif %}
    </header>

    <main class="px-4 py-4">

      {# Flash messages #}
      {% for label, messages in app.flashes %}
        {% for message in messages %}
          <div class="alert alert-{{ label == 'error' ? 'danger' : label }} shadow-sm">
            {{ message }}
          </div>
        {% endfor %}
      {% endfor %}

      {% block body %}{% endblock %}

    </main>

  </div>

</div>

{# Bootstrap JS #}
<script src="{{ asset('assets/vendor/bootstrap/js/bootstrap.bundle.min.js') }}"></script>

{% block javascripts %}{% endblock %}

</body>
</html>
