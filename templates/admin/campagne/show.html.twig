{% extends 'admin/base_admin.html.twig' %}

{% block title %}Campagne #{{ c.id }} | WasteWise TN{% endblock %}
{% block page_title %}Campagnes{% endblock %}

{% block sidebar %}
  {% include 'admin/_sidebar.html.twig' %}
{% endblock %}

{% block body %}

<div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-4">
  <div>
    <h2 class="mb-0">ðŸ“£ {{ c.titre }}</h2>
    <div class="text-muted small">DÃ©tails campagne â€” ID #{{ c.id }}</div>
  </div>

  <div class="d-flex gap-2 flex-wrap">
    <a class="btn btn-primary" href="{{ path('admin_campagne_edit', { id: c.id }) }}">
      <i class="bi bi-pencil"></i> Modifier
    </a>

    <a class="btn btn-outline-secondary" href="{{ path('admin_campagne_index') }}">
      <i class="bi bi-arrow-left"></i> Retour
    </a>
  </div>
</div>

{# âœ… Flash messages (optionnel) #}
{% for label, messages in app.flashes %}
  {% for msg in messages %}
    <div class="alert alert-{{ label == 'error' ? 'danger' : label }} shadow-sm">
      {{ msg }}
    </div>
  {% endfor %}
{% endfor %}

<div class="row g-4">

  {# ================= INFOS ================= #}
  <div class="col-lg-8">
    <div class="card shadow-sm border-0">
      <div class="card-header bg-white fw-bold">Informations</div>

      <div class="card-body">
        <div class="row g-3 align-items-start">

          <div class="col-12 col-md-8">
            <div class="text-muted small">PÃ©riode</div>
            <div class="fw-semibold">
              {{ c.dateDebut ? c.dateDebut|date('d/m/Y') : 'â€”' }}
              â†’
              {{ c.dateFin ? c.dateFin|date('d/m/Y') : 'â€”' }}
            </div>
          </div>

          <div class="col-12 col-md-4 text-md-end">
            {% if c.statut == 'ACTIVE' %}
              <span class="badge bg-success fs-6">ACTIVE</span>
            {% elseif c.statut == 'BROUILLON' %}
              <span class="badge bg-warning text-dark fs-6">BROUILLON</span>
            {% else %}
              <span class="badge bg-secondary fs-6">TERMINEE</span>
            {% endif %}
          </div>

        </div>

        <hr class="my-4">

        <div>
          <div class="text-muted small mb-2">Description</div>
          <div class="border rounded-3 p-3 bg-light">
            {{ c.description ?: 'â€”' }}
          </div>
        </div>
      </div>
    </div>
  </div>

  {# ================= ACTIONS RAPIDES ================= #}
  <div class="col-lg-4">
    <div class="card shadow-sm border-0">
      <div class="card-header bg-white fw-bold">Actions rapides</div>

      <div class="card-body d-grid gap-2">
        <a class="btn btn-outline-primary" href="{{ path('admin_campagne_edit', { id: c.id }) }}">
          <i class="bi bi-pencil"></i> Modifier campagne
        </a>

        <a class="btn btn-outline-secondary" href="{{ path('admin_campagne_index') }}">
          <i class="bi bi-list-ul"></i> Liste des campagnes
        </a>

        <div class="border-top pt-3">
          <div class="text-muted small mb-2">Suppression</div>

          <form method="post"
                action="{{ path('admin_campagne_delete', { id: c.id }) }}"
                onsubmit="return confirm('Supprimer cette campagne ?');">
            <input type="hidden" name="_token" value="{{ csrf_token('delete_campagne_' ~ c.id) }}">
            <button class="btn btn-outline-danger w-100" type="submit">
              <i class="bi bi-trash"></i> Supprimer
            </button>
          </form>

          <div class="form-text mt-2">
            Cette action est irrÃ©versible.
          </div>
        </div>

      </div>
    </div>
  </div>

</div>

{% endblock %}
