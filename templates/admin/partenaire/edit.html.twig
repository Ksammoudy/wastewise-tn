{% extends 'admin/base_admin.html.twig' %}

{% block title %}Modifier partenaire | WasteWise TN{% endblock %}
{% block page_title %}Partenaires{% endblock %}

{% block sidebar %}
  {% include 'admin/_sidebar.html.twig' %}
{% endblock %}

{% block body %}

<div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-4">
  <div>
    <h2 class="mb-0">✏️ Modifier partenaire</h2>
    <div class="text-muted small">
      Partenaire : <b>{{ p.nomEntreprise }}</b> — Mise à jour des informations
    </div>
  </div>

  <div class="d-flex gap-2 flex-wrap">
    <a class="btn btn-outline-secondary" href="{{ path('partenaire_show', { id: p.id }) }}">
      <i class="bi bi-arrow-left"></i> Retour
    </a>

    <a class="btn btn-outline-primary" href="{{ path('partenaire_index') }}">
      <i class="bi bi-list"></i> Liste partenaires
    </a>
  </div>
</div>

<div class="row g-4">

  {# ================= FORMULAIRE ================= #}
  <div class="col-lg-8">
    <div class="card shadow-sm border-0">
      <div class="card-header bg-white d-flex align-items-center justify-content-between">
        <div class="fw-bold">Formulaire</div>
        <span class="badge bg-light text-dark border">
          <i class="bi bi-pencil-square"></i> Édition
        </span>
      </div>

      <div class="card-body">

        {{ form_start(form, { attr: { novalidate: 'novalidate', class: 'row g-3' } }) }}

          <div class="col-12 col-md-6">
            {{ form_label(form.nomEntreprise, 'Nom de l’entreprise', { label_attr: { class: 'form-label' } }) }}
            {{ form_widget(form.nomEntreprise, { attr: { class: 'form-control', placeholder: 'Ex: EcoMarket' } }) }}
            <div class="text-danger small">{{ form_errors(form.nomEntreprise) }}</div>
          </div>

          <div class="col-12 col-md-6">
            {{ form_label(form.categorie, 'Catégorie', { label_attr: { class: 'form-label' } }) }}
            {{ form_widget(form.categorie, { attr: { class: 'form-control', placeholder: 'Ex: Supermarché / Restaurant / Boutique...' } }) }}
            <div class="text-danger small">{{ form_errors(form.categorie) }}</div>
          </div>

          <div class="col-12">
            {{ form_label(form.siteWeb, 'Site web (optionnel)', { label_attr: { class: 'form-label' } }) }}
            {{ form_widget(form.siteWeb, {
              attr: { class: 'form-control', placeholder: 'https://www.exemple.com' }
            }) }}
            <div class="text-danger small">{{ form_errors(form.siteWeb) }}</div>
          </div>

          <div class="col-12">
            <div class="form-check">
              {{ form_widget(form.actif, { attr: { class: 'form-check-input' } }) }}
              {{ form_label(form.actif, 'Partenaire actif (visible et utilisable)', { label_attr: { class: 'form-check-label' } }) }}
            </div>
            <div class="text-danger small">{{ form_errors(form.actif) }}</div>
          </div>

          {# ✅ CSRF + champs cachés #}
          {{ form_rest(form) }}

          <div class="col-12 d-flex justify-content-end gap-2 mt-2 flex-wrap">
            <a class="btn btn-outline-secondary" href="{{ path('partenaire_show', { id: p.id }) }}">
              <i class="bi bi-x-circle"></i> Annuler
            </a>

            <button class="btn btn-primary" type="submit">
              <i class="bi bi-save"></i> Mettre à jour
            </button>
          </div>

        {{ form_end(form) }}

      </div>
    </div>
  </div>

  {# ================= ACTIONS RAPIDES ================= #}
  <div class="col-lg-4">
    <div class="card shadow-sm border-0">
      <div class="card-header bg-white fw-bold">Actions rapides</div>

      <div class="card-body d-grid gap-2">
        <a class="btn btn-outline-dark" href="{{ path('partenaire_show', { id: p.id }) }}">
          <i class="bi bi-eye"></i> Voir détails
        </a>

        <a class="btn btn-outline-secondary" href="{{ path('partenaire_index') }}">
          <i class="bi bi-list-ul"></i> Liste des partenaires
        </a>

        <div class="border-top pt-3">
          <div class="text-muted small mb-2">Aide</div>
          <div class="small text-muted">
            Désactive “Actif” si tu veux cacher ce partenaire (et ses récompenses).
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

{% endblock %}
