{# templates/citoyen/appel_proposer.html.twig #}
{% extends 'citoyen/base.html.twig' %}

{% block title %}Proposition | WasteWise TN{% endblock %}

{% block body %}

{# ===== HEADER ===== #}
<div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-4">
  <div>
    <h2 class="mb-0 ww-title">ðŸ“¨ Envoyer une proposition</h2>
    <div class="ww-subtitle">
      Appel : <b>{{ appel.titre }}</b>
    </div>
  </div>

  <a class="btn btn-outline-secondary" href="{{ path('cit_appel_show', { id: appel.id }) }}">
    <i class="bi bi-arrow-left"></i> Retour
  </a>
</div>

{# (optionnel) Flash messages: ton base.html.twig les affiche dÃ©jÃ ,
   donc tu peux supprimer ce bloc si tu veux Ã©viter le double affichage. #}
{% for label, messages in app.flashes %}
  {% for message in messages %}
    {% set bs = (label == 'error' or label == 'danger') ? 'danger' : label %}
    <div class="alert alert-{{ bs }} shadow-sm mb-3">
      {{ message }}
    </div>
  {% endfor %}
{% endfor %}

<div class="row justify-content-center">
  <div class="col-12 col-lg-9 col-xl-7">

    <div class="ww-card">
      <div class="ww-card-h">Formulaire</div>
      <div class="ww-card-b">

        {{ form_start(form, { attr: { novalidate: 'novalidate' } }) }}

          {# erreurs globales #}
          {% if form.vars.errors|length > 0 %}
            <div class="alert alert-danger mb-3">
              {{ form_errors(form) }}
            </div>
          {% endif %}

          <div class="row g-3">
            <div class="col-12 col-md-6">
              {{ form_label(form.nomProposant, 'Nom', { label_attr: { class: 'form-label' } }) }}
              {{ form_widget(form.nomProposant, { attr: { class: 'form-control', placeholder: 'Votre nom' } }) }}
              <div class="text-danger small mt-1">{{ form_errors(form.nomProposant) }}</div>
            </div>

            <div class="col-12 col-md-6">
              {{ form_label(form.email, 'Email', { label_attr: { class: 'form-label' } }) }}
              {{ form_widget(form.email, { attr: { class: 'form-control', placeholder: 'ex: nom@mail.com' } }) }}
              <div class="text-danger small mt-1">{{ form_errors(form.email) }}</div>
            </div>

            <div class="col-12 col-md-6">
              {{ form_label(form.montant, 'Montant (DT)', { label_attr: { class: 'form-label' } }) }}
              {{ form_widget(form.montant, { attr: { class: 'form-control', placeholder: 'Ex: 250', min: 0 } }) }}
              <div class="text-danger small mt-1">{{ form_errors(form.montant) }}</div>
            </div>

            <div class="col-12 col-md-6">
              {{ form_label(form.delaiJours, 'DÃ©lai (jours)', { label_attr: { class: 'form-label' } }) }}
              {{ form_widget(form.delaiJours, { attr: { class: 'form-control', placeholder: 'Ex: 7', min: 1 } }) }}
              <div class="text-danger small mt-1">{{ form_errors(form.delaiJours) }}</div>
            </div>

            <div class="col-12">
              {{ form_label(form.message, 'Message', { label_attr: { class: 'form-label' } }) }}
              {{ form_widget(form.message, { attr: { class: 'form-control', rows: 5, placeholder: 'Explique ta proposition...' } }) }}
              <div class="text-danger small mt-1">{{ form_errors(form.message) }}</div>
            </div>
          </div>

          <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mt-4">
            <div class="text-muted small">
              VÃ©rifie le montant et le dÃ©lai avant dâ€™envoyer.
            </div>

            <div class="d-flex gap-2 flex-wrap">
              <a class="btn btn-outline-secondary" href="{{ path('cit_appel_show', { id: appel.id }) }}">
                Annuler
              </a>
              <button class="btn btn-success" type="submit">
                <i class="bi bi-send"></i> Envoyer
              </button>
            </div>
          </div>

        {{ form_end(form) }}

      </div>
    </div>

  </div>
</div>

{% endblock %}
