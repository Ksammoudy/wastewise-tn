{# templates/citoyen/appel_show.html.twig #}
{% extends 'citoyen/base.html.twig' %}

{% block title %}DÃ©tails appel | WasteWise TN{% endblock %}

{% block body %}

{# ===== HEADER ===== #}
<div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-4">
  <div>
    <h2 class="mb-0 ww-title">ðŸ“£ {{ appel.titre }}</h2>
    <div class="ww-subtitle">
      Du {{ appel.dateDebut ? appel.dateDebut|date('d/m/Y') : 'â€”' }}
      au {{ appel.dateFin ? appel.dateFin|date('d/m/Y') : 'â€”' }}
    </div>
  </div>

  <div class="d-flex align-items-center gap-2 flex-wrap">
    {# Badge statut : BROUILLON / PUBLIE / FERME #}
    {% set st = appel.statut|default('BROUILLON') %}

    {% if st == 'PUBLIE' %}
      <span class="ww-badge"><i class="bi bi-check-circle"></i> PUBLIE</span>
    {% elseif st == 'FERME' %}
      <span class="ww-badge"><i class="bi bi-lock"></i> FERME</span>
    {% else %}
      <span class="ww-badge"><i class="bi bi-pencil-square"></i> BROUILLON</span>
    {% endif %}

    <a class="btn btn-outline-secondary" href="{{ path('cit_appel_index') }}">
      <i class="bi bi-arrow-left"></i> Retour
    </a>
  </div>
</div>

{# (optionnel) Flash messages: ton base.html.twig les affiche dÃ©jÃ ,
   donc tu peux supprimer ce bloc si tu veux Ã©viter le double affichage. #}
{% for label, messages in app.flashes %}
  {% for message in messages %}
    {% set bs = (label == 'error' or label == 'danger') ? 'danger' : label %}
    <div class="alert alert-{{ bs }} shadow-sm mb-3">
      {{ message }}
    </div>
  {% endfor %}
{% endfor %}

{# ===== DESCRIPTION ===== #}
<div class="ww-card">
  <div class="ww-card-h">Description</div>

  <div class="ww-card-b">
    <div class="text-muted" style="line-height:1.7;">
      {{ appel.description ?: 'â€”' }}
    </div>

    <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mt-4">
      <div class="text-muted small">
        VÃ©rifie les dates et le statut avant de postuler.
      </div>

      <div class="d-flex gap-2 flex-wrap">
        {% if appel.isOuvert() %}
          <a class="btn btn-success"
             href="{{ path('cit_appel_proposer', { id: appel.id }) }}">
            <i class="bi bi-send"></i> Envoyer une proposition
          </a>
        {% else %}
          <button class="btn btn-secondary" disabled>
            <i class="bi bi-lock"></i> Appel non ouvert
          </button>
        {% endif %}
      </div>
    </div>

  </div>
</div>

{% endblock %}
