{# templates/citoyen/base_citoyen.html.twig #}
<!DOCTYPE html>
<html lang="fr">
<head>
<style>
  /* Background général (moins blanc) */
  .page-wrapper{
    background:#f6f8fb !important;
  }

  /* Container "propre" dans chaque page */
  .ww-page-bg{
    background:#f6f8fb;
    border:1px solid rgba(0,0,0,.06);
    border-radius:16px;
    padding:18px;
  }

  /* Titres */
  .ww-title{
    font-weight:900;
    letter-spacing:-.3px;
    color:#0f172a;
  }
  .ww-subtitle{
    color:#64748b;
  }

  /* Cards modernes */
  .ww-card{
    border:1px solid rgba(0,0,0,.06);
    border-radius:14px;
    box-shadow:0 10px 30px rgba(15,23,42,.06);
  }

  /* Cartes type “tender/reward” */
  .ww-soft-card{
    border:1px solid rgba(0,0,0,.06);
    border-radius:16px;
    box-shadow:0 10px 30px rgba(15,23,42,.06);
    background:#fff;
    transition:transform .15s ease, box-shadow .15s ease;
  }
  .ww-soft-card:hover{
    transform:translateY(-2px);
    box-shadow:0 18px 44px rgba(15,23,42,.10);
  }

  /* Badges lisibles */
  .ww-badge{
    background:#f1f5f9;
    color:#0f172a;
    border:1px solid rgba(0,0,0,.06);
    font-weight:600;
    padding:.35rem .55rem;
    border-radius:999px;
    font-size:.82rem;
    display:inline-flex;
    gap:.35rem;
    align-items:center;
  }
</style>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Citizen | WasteWise{% endblock %}</title>

  {# Vendor CSS #}
  <link rel="stylesheet" href="{{ asset('assets/vendor/bootstrap/css/bootstrap.min.css') }}">
  <link rel="stylesheet" href="{{ asset('assets/vendor/bootstrap-icons/bootstrap-icons.css') }}">
  <link rel="stylesheet" href="{{ asset('assets/vendor/font-awesome/css/all.min.css') }}">
  <link rel="stylesheet" href="{{ asset('assets/vendor/overlay-scrollbar/css/OverlayScrollbars.min.css') }}">

  {# Template CSS #}
  <link rel="stylesheet" href="{{ asset('assets/css/style.css') }}">

  <style>
    .main-wrapper{ display:flex; min-height:100vh; }
    .sidebar{
      width:280px; flex:0 0 280px;
      border-right:1px solid rgba(0,0,0,.08);
      background:#fff;
    }
    .page-wrapper{ flex:1 1 auto; min-width:0; background:#f8fafc; }
    .page-header{ position:sticky; top:0; z-index:10; }

    /* Sidebar links look */
    .sidebar .nav-link{
      border-radius:10px;
      padding:.6rem .8rem;
      color:#334155;
    }
    .sidebar .nav-link:hover{ background:rgba(2,6,23,.04); }
    .sidebar .nav-link.active{
      background:#0d6efd;
      color:#fff !important;
    }
    .sidebar .nav-link.active i{ color:#fff; }

    /* Responsive: sidebar collapses */
    @media (max-width: 991.98px){
      .main-wrapper{ flex-direction:column; }
      .sidebar{
        width:100%; flex:0 0 auto;
        border-right:none;
        border-bottom:1px solid rgba(0,0,0,.08);
      }
      .page-header{ position:static; }
    }
  </style>

  {% block stylesheets %}{% endblock %}
</head>

<body>

{% set route = app.request.attributes.get('_route') %}
{% set userLabel = app.user ? app.user.userIdentifier : 'Guest' %}
{% set firstChar = userLabel|first|upper %}

<div class="main-wrapper">

  {# ===== SIDEBAR ===== #}
  <aside class="sidebar">

    <div class="p-3 border-bottom">
      <a href="{{ path('app_dashboard_citoyen') }}" class="d-flex align-items-center gap-2 text-decoration-none">
        <span class="fw-bold text-success">WasteWise TN</span>
      </a>
      <div class="small text-muted">Citizen Area</div>
    </div>

    <div class="p-3 border-bottom">
      <div class="d-flex align-items-center gap-2">
        <div class="rounded-circle d-flex align-items-center justify-content-center fw-bold"
             style="width:42px;height:42px;background:#e8f5ee;color:#166534;">
          {{ firstChar }}
        </div>

        <div class="min-w-0">
          <div class="fw-semibold text-truncate">{{ userLabel }}</div>
          <div class="small text-muted">
            {{ attribute(app.user, 'type') is defined ? app.user.type : 'USER' }}
          </div>
        </div>
      </div>
    </div>

    <div class="px-2 py-3">
      <ul class="nav flex-column gap-1">

        <li class="nav-item">
          <a class="nav-link {{ route == 'app_dashboard_citoyen' ? 'active fw-bold' : '' }}"
             href="{{ path('app_dashboard_citoyen') }}">
            <i class="bi bi-house me-2"></i> Dashboard
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link {{ route in ['dechet_nouveau','citoyen_dechet_nouveau'] ? 'active fw-bold' : '' }}"
             href="{{ path('dechet_nouveau') }}">
            <i class="bi bi-trash3 me-2"></i> Declare Waste
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link {{ route == 'citoyen_declarations' ? 'active fw-bold' : '' }}"
             href="{{ path('citoyen_declarations') }}">
            <i class="bi bi-file-earmark-text me-2"></i> My Declarations
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link {{ route == 'citoyen_impact' ? 'active fw-bold' : '' }}"
             href="{{ path('citoyen_impact') }}">
            <i class="bi bi-globe-europe-africa me-2"></i> Environmental Impact
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link {{ route == 'app_citoyen_recompenses' ? 'active fw-bold' : '' }}"
             href="{{ path('app_citoyen_recompenses') }}">
            <i class="bi bi-gift me-2"></i> Rewards
          </a>
        </li>

        {# Optionnel: page des récompenses acquises #}
        <li class="nav-item">
          <a class="nav-link {{ route == 'app_citoyen_recompenses_acquises' ? 'active fw-bold' : '' }}"
             href="{{ path('app_citoyen_recompenses_acquises') }}">
            <i class="bi bi-award me-2"></i> My Rewards
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link {{ route == 'app_citoyen_campagnes' ? 'active fw-bold' : '' }}"
             href="{{ path('app_citoyen_campagnes') }}">
            <i class="bi bi-megaphone me-2"></i> Campaigns
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link {{ route starts with 'cit_appel_' ? 'active fw-bold' : '' }}"
             href="{{ path('cit_appel_index') }}">
            <i class="bi bi-pencil-square me-2"></i> Tenders
          </a>
        </li>

        <li class="nav-item mt-2">
          <a class="nav-link text-danger" href="{{ path('app_logout') }}">
            <i class="bi bi-box-arrow-right me-2"></i> Logout
          </a>
        </li>

      </ul>
    </div>

  </aside>

  {# ===== PAGE CONTENT ===== #}
  <div class="page-wrapper">

    <header class="page-header bg-white border-bottom px-4 py-3 d-flex align-items-center justify-content-between">
      <div class="fw-bold">Citizen</div>

      {% if app.user %}
        <div class="d-flex align-items-center gap-2">
          <i class="bi bi-person-circle"></i>
          <span class="small text-muted">{{ app.user.userIdentifier }}</span>
        </div>
      {% endif %}
    </header>

    <main class="px-4 py-4">

      {# Flash messages #}
      {% for label, messages in app.flashes %}
        {% for message in messages %}
          {% set bs = label == 'error' ? 'danger' : label %}
          <div class="alert alert-{{ bs }} shadow-sm mb-3">
            {{ message }}
          </div>
        {% endfor %}
      {% endfor %}

      {% block body %}{% endblock %}
    </main>

  </div>
</div>

{# Vendor JS #}
<script src="{{ asset('assets/vendor/bootstrap/js/bootstrap.bundle.min.js') }}"></script>
<script src="{{ asset('assets/vendor/overlay-scrollbar/js/OverlayScrollbars.min.js') }}"></script>

{% block javascripts %}{% endblock %}

</body>
</html>
